{"version":3,"sources":["app/app.coffee","app/script.js","app/scripts/controllers/patientdetails.coffee","app/scripts/controllers/patientslist.coffee","app/scripts/demo.coffee","app/scripts/services/ehrlookup.coffee"],"names":[],"mappings":"AAAA;AAAA;;AAAA,GAGA,GAAM,OAAO,CAAC,MAAR,CAAe,KAAf,EAAsB,CAC1B,SAD0B,CAAtB,CAHN;;AAAA,GAYG,CAAC,MAAJ,CAAW;EACT,gBADS,EAGT,SAAC,cAAD;WACE,cAEE,CAAC,IAFH,CAEQ,WAFR,EAGI;AAAA,mBAAa,yBAAb;AAAA,MACA,YAAY,wBADZ;KAHJ,CAME,CAAC,IANH,CAMQ,kBANR,EAOI;AAAA,mBAAa,0BAAb;AAAA,MACA,YAAY,yBADZ;KAPJ,CAUE,CAAC,SAVH,CAWI;AAAA,kBAAY,WAAZ;KAXJ,EADF;EAAA,CAHS;CAAX,CAZA;CCAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;CC1JA;AAAA,GAEG,CAAC,UAAJ,CAAe,yBAAf,EACE,SAAC,MAAD,EAAS,UAAT,EAAqB,SAArB,E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","file":"js/app.js","sourcesContent":["'use strict'\n\n# Declare app level module which depends on filters, and services\nApp = angular.module 'app', [\n  'ngRoute'\n  # 'app.controllers'\n  # 'app.directives'\n  # 'app.filters'\n  # 'app.services'\n  # 'partials'\n]\n\nApp.config([\n  '$routeProvider'\n\n  ($routeProvider) ->\n    $routeProvider\n\n      .when '/patients',\n        templateUrl: 'views/patientsList.html'\n        controller: 'PatientsListController'\n\n      .when '/patients/:ehrid',\n        templateUrl: 'views/patientDetail.html'\n        controller: 'PatientDetailController'\n\n      .otherwise\n        redirectTo: '/patients'\n])\n","/* global d3 */\n\nvar hArr = [61,68,79,68,67,82,52,89,74,68,73,50,58,81,82,50,60,57,76,79,70,79,\n            84,89,70,51,52,90,90,59,58,82,74,57,60,50,89,63,88,67,59,88,79,51,\n            58,85,73,74,54,69,53,68,63,78,68,50,61,82,59,79,67,78,77,61,64,71,\n            53,51,84,71,64,52,89,51,57,86,50,74,75,64,71,86,59,83,51,63,77,83,\n            79,77,65,66,55,88,67,80,80,70,79,53];\n\nvar margin = {\n        top: 20,\n        right: 20,\n        bottom: 30,\n        left: 50\n    },\n    width = 960 - margin.left - margin.right,\n    height = 500 - margin.top - margin.bottom;\n\nvar colors = d3.scale.linear()\n            .range([height, 0])\n            .range(['#ff0000', '#00ff00']);\n\nvar parseDate = d3.time.format('%m/%d/%Y').parse;\n\n\nvar x = d3.time.scale()\n    .range([0, width]);\n\nvar y = d3.scale.linear()\n    .range([height, 0]);\n\nvar xAxis = d3.svg.axis()\n    .scale(x)\n    .orient('bottom');\n\nvar yAxis = d3.svg.axis()\n    .scale(y)\n    .orient('left');\n\nvar line = d3.svg.line()\n    .x(function(d) {\n        'use strict';\n        return x(d.date);\n    })\n    .y(function(d) {\n        'use strict';\n        return y(d.close);\n    });\n\nvar svg = d3.select('body').append('svg')\n    .attr('width', width + margin.left + margin.right)\n    .attr('height', height + margin.top + margin.bottom)\n    .append('g')\n    .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\n\nvar curDate = new Date();\n\nfunction nextDate () {\n    'use strict';\n    curDate.setDate(curDate.getDate() + 1);\n    return curDate.toLocaleDateString();\n}\n\nvar data = hArr.map(function(d) {\n    'use strict';\n    return {\n        date: parseDate(nextDate()),\n        close: d\n    };\n\n});\n\n// console.log(data);\n\n\nx.domain(d3.extent(data, function(d) {\n    'use strict';\n    return d.date;\n}));\n// y.domain(d3.extent(data, function(d) {\n//     'use strict';\n//     return d.close;\n// }));\ny.domain([\n    d3.min(data, function(d) {\n        'use strict';\n        return d.close;\n    }) * 0.95,\n    d3.max(data, function(d) {\n        'use strict';\n        return d.close;\n    }) * 1.05\n]);\n\nvar area = d3.svg.area()\n    .x(function(d) {\n        'use strict';\n        return x(d.date);\n    })\n    .y0(height)\n    .y1(function(d) {\n        'use strict';\n        return y(d.close);\n    });\n\nsvg.append('g')\n    .attr('class', 'x axis')\n    .attr('transform', 'translate(0,' + height + ')')\n    .call(xAxis);\n\nsvg.append('g')\n    .attr('class', 'y axis')\n    .call(yAxis)\n    .append('text')\n    .attr('transform', 'rotate(-90)')\n    .attr('y', 6)\n    .attr('dy', '.71em')\n    .style('text-anchor', 'end')\n    .text('Heart rate [bpm]');\n\nsvg.append(\"linearGradient\")\n        .attr(\"id\", \"area-gradient\")                // change from line to area\n        .attr(\"gradientUnits\", \"userSpaceOnUse\")\n        .attr(\"x1\", 0).attr(\"y1\", y(0))\n        .attr(\"x2\", 0).attr(\"y2\", y(200))\n    .selectAll(\"stop\")\n        .data([\n            {offset: \"0%\", color: \"red\"},\n            {offset: \"10%\", color: \"blue\"},\n            {offset: \"20%\", color: \"yellow\"},\n            {offset: \"30%\", color: \"red\"},\n            {offset: \"45%\", color: \"black\"},\n            {offset: \"55%\", color: \"black\"},\n            {offset: \"60%\", color: \"lawngreen\"},\n            {offset: \"100%\", color: \"lawngreen\"}\n        ])\n    .enter().append(\"stop\")\n        .attr(\"offset\", function(d) {\n            'use strict';\n            return d.offset;\n        })\n        .attr(\"stop-color\", function(d) {\n            'use strict';\n            return d.color;\n        });\n\n// svg.append('path')\n//         .datum(data)\n//         .attr('class', 'area')\n//         .attr('d', area);\n\nsvg.append('path')\n    .datum(data)\n    .attr('class', 'line')\n    .attr('d', line)\n","'use strict'\n\nApp.controller 'PatientDetailController',\n  ($scope, $rootScope, $location, EhrLookup) ->\n    $rootScope.title = 'Details for name'\n\n    EhrLookup.getAllData ehrId, sessionId, (data) -> $scope.patient = data\n","'use strict'\n\n\n\nApp.controller 'PatientsListController',\n  ($scope, $rootScope, $location, EhrLookup) ->\n\n    $rootScope.title = 'Patient list'\n\n    ehrIds = [\n      'b931580f-2b05-488b-985b-8d9ffb08ad02'\n      'd564c6a3-5a43-4fcc-bfa7-9ac76e9673bd'\n      '7b661e12-3a98-21ad-c29e-2dc9f5a3d885'\n    ]\n\n    sessionId = EhrLookup.getSessionId()\n\n    $scope.patients = []\n    for ehrId in ehrIds\n      EhrLookup.getAllData ehrId, sessionId, (data) ->\n        return if not data\n        $scope.patients.push data\n\n\n    $scope.viewPatient = (key) ->\n      $location.path \"/patients/#{key}\"\n\n    $scope.graphOptionChange = (val) ->\n      console.log \"change, #{val}\"\n","String::isNullOrEmpty = ->\n  @trim().length is 0\n\nbaseUrl = \"https://rest.ehrscape.com/rest/v1\"\nqueryUrl = baseUrl + \"/query\"\nusername = encodeURIComponent \"ois.seminar\"\npassword = encodeURIComponent \"ois4fri\"\n\nLabel = {\n  \"success\": \"label-success\"\n  \"warning\": \"label-warning\"\n  \"danger\": \"label-danger\"\n}\n\n\ngetSessionId = ->\n  $.ajax\n    type: \"POST\"\n    url: \"#{baseUrl}/session?username=#{username}&password=#{password}\"\n    async: false\n  .responseJSON.sessionId\n\nshowMessage = (msg, element, classes = \"\") ->\n  return if not element\n  allClasses = \"obvestilo label fade-in #{classes}\"\n  $(element).html(\"<span>#{msg}</span>\").addClass(allClasses)\n\nhandleError = (err, msgEl) ->\n  msg = JSON.parse(err.responseText).userMessage\n  showMessage msg, msgEl, Label.danger\n  console.log msg\n\ncreateEHR = ->\n  sessionId = getSessionId()\n  ime = $(\"#kreirajIme\").val() or \"\"\n  priimek = $(\"#kreirajPriimek\").val() or \"\"\n  datum = $(\"#kreirajDatumRojstva\").val() or \"\"\n  msgEl = $(\"#kreirajSporocilo\")\n\n  if ime.isNullOrEmpty?() or priimek.isNullOrEmpty?() or datum.isNullOrEmpty?()\n    return showMessage \"Prosim vnesite zahtevane podatke!\", msgEl, Label.warning\n\n  $.ajaxSetup\n    headers:\n      \"Ehr-Session\": sessionId\n  $.ajax\n    url: \"#{baseUrl}/ehr\"\n    type: \"POST\"\n    success: (data) ->\n      ehrId = data.ehrId\n      partyData =\n        firstNames: ime\n        lastNames: priimek\n        dateOfBirth: datum\n        partyAdditionalInfo: [\n          key: \"ehrId\"\n          value: ehrId\n        ]\n      $.ajax\n        url: \"#{baseUrl}/demographics/party\"\n        type: \"POST\"\n        contentType: \"application/json\"\n        data: JSON.stringify partyData\n        success: (party) ->\n          if party.action is \"CREATE\"\n            msg = \"Uspešno kreiran EHR '#{ehrId}'.\"\n            showMessage msg, msgEl, Label.success\n            console.log msg\n            $(\"#preberiEHRid\").val ehrId\n        error: (err) -> handleError err, msgEl\n\nreadEHR = ->\n  sessionId = getSessionId()\n  ehrId = $(\"#preberiEHRid\").val() or \"\"\n  msgEl = $(\"#preberiSporocilo\")\n  if ehrId.isNullOrEmpty?()\n    return showMessage \"Prosim vnesite zahtevan podatek!\", msgEl, Label.warning\n\n  $.ajax\n    url: \"#{baseUrl}/demographics/ehr/#{ehrId}/party\"\n    type: \"GET\"\n    headers:\n      \"Ehr-Session\": sessionId\n    success: (data) ->\n      p = data.party\n      msg = \"Bolnik #{p.firstNames} #{p.lastNames}, rojen #{p.dateOfBirth}.\"\n      showMessage msg, msgEl, Label.success\n      console.log msg\n    error: (err) -> handleError err, msgEl\n\naddMeasurements = ->\n  sessionId = getSessionId()\n  ehrId = $(\"#preberiEHRid\").val() or \"\"\n  msgEl = $(\"#dodajMeritveVitalnihZnakovSporocilo\")\n  if ehrId.isNullOrEmpty?()\n    return showMessage \"Prosim vnesite zahtevan podatek!\", msgEl, Label.warning\n\n  datumInUra = $(\"#dodajVitalnoDatumInUra\").val()\n  visina = $(\"#dodajVitalnoTelesnaVisina\").val()\n  teza = $(\"#dodajVitalnoTelesnaTeza\").val()\n  temperatura = $(\"#dodajVitalnoTelesnaTemperatura\").val()\n  sistolicniKrvniTlak = $(\"#dodajVitalnoKrvniTlakSistolicni\").val()\n  diastolicniKrvniTlak = $(\"#dodajVitalnoKrvniTlakDiastolicni\").val()\n  nasicenostKrviSKisikom = $(\"#dodajVitalnoNasicenostKrviSKisikom\").val()\n  merilec = $(\"#dodajVitalnoMerilec\").val()\n\n  podatki =\n    \"ctx/language\": \"en\"\n    \"ctx/territory\": \"SI\"\n    \"ctx/time\": datumInUra\n    \"vital_signs/height_length/any_event/body_height_length\": visina\n    \"vital_signs/body_weight/any_event/body_weight\": teza\n    \"vital_signs/body_temperature/any_event/temperature|magnitude\": temperatura\n    \"vital_signs/body_temperature/any_event/temperature|unit\": \"°C\"\n    \"vital_signs/blood_pressure/any_event/systolic\": sistolicniKrvniTlak\n    \"vital_signs/blood_pressure/any_event/diastolic\": diastolicniKrvniTlak\n    \"vital_signs/indirect_oximetry:0/spo2|numerator\": nasicenostKrviSKisikom\n\n  parametriZahteve =\n    \"ehrId\": ehrId\n    \"templateId\": \"Vital Signs\"\n    \"format\": \"FLAT\"\n    \"committer\": merilec\n\n  $.ajaxSetup\n    headers:\n      \"Ehr-Session\": sessionId\n\n  $.ajax\n    url: \"#{baseUrl}/composition?#{$.param parametriZahteve}\"\n    type: \"POST\"\n    contentType: \"application/json\"\n    data: JSON.stringify podatki\n    suceess: (res) ->\n      msg = res.meta.href\n      showMessage msg, msgEl, Label.success\n      console.log msg\n    error: (err) -> handleError err, msgEl\n\nreadResultsAsync = (sId, url, title, msgEl, successCallback, addResult) ->\n  $.ajax\n    url: url\n    type: \"GET\"\n    headers:\n      \"Ehr-Session\": sId\n    success: (res) -> successCallback res, title, msgEl, addResult\n    error: (err) -> handleError err, msgEl\n\nreadAsyncSuccess = (res, title, msgEl, addResult) ->\n  if res.length > 0\n    results = \"\"\"\n      <table class=\"table table-striped table-hover\">\n        <tr>\n          <th>Datum in ura</th>\n          <th class=\"text-right\">#{title}</th>\n        </tr>\n      \"\"\"\n    results += addResult val for key, val of res\n    $(\"#rezultatMeritveVitalnihZnakov\").append results + \"</table>\"\n  else\n    showMessage \"Ni podatkov!\", msgEl, Label.warning\n\nreadMeasurements = ->\n  sessionId = getSessionId()\n  ehrId = $(\"#meritveVitalnihZnakovEHRid\").val() or \"\"\n  type = $(\"#preberiTipZaVitalneZnake\").val() or \"\"\n  msgEl = $(\"#preberiMeritveVitalnihZnakovSporocilo\")\n\n  if ehrId.isNullOrEmpty?() or type.isNullOrEmpty?()\n    return showMessage \"Prosim vnesite zahtevan podatek!\", msgEl, Label.warning\n\n  $.ajax\n    url: \"#{baseUrl}/demographics/ehr/#{ehrId}/party\"\n    type: \"GET\"\n    headers:\n      \"Ehr-Session\": sessionId\n    success: (data) ->\n      party = data.party\n      el = $(\"#rezultatMeritveVitalnihZnakov\")\n      name = \"#{party.firstNames} #{party.lastNames}\"\n      msg = \"Pridobivanje podatkov za <b>#{type}</b> bolnika #{name}<b></b>.\"\n      el.html \"<br/><span>#{msg}</span><br/><br/>\"\n\n      if type is \"telesna temperatura\"\n        url = \"#{baseUrl}/view/#{ehrId}/body_temperature\"\n        title = \"Telesna temperatura\"\n        successHandler = readAsyncSuccess\n        addResult = (result) ->\n          \"\"\"<tr>\n            <td>#{result.time}</td>\n            <td class=\"text-right\">\n              #{result.temperature} #{result.unit}\n            </td>\n          </tr>\"\"\"\n      else if type is \"telesna teža\"\n        url = \"#{baseUrl}/view/#{ehrId}/weight\"\n        title = \"Telesna teža\"\n        successHandler = readAsyncSuccess\n        addResult = (result) ->\n          \"\"\"<tr>\n            <td>#{result.time}</td>\n            <td class=\"text-right\">\n              #{result.weight} #{result.unit}\n            </td>\n          </tr>\"\"\"\n      else if type is \"telesna temperatura AQL\"\n        AQL = \"\"\"\n          select\n            t/data[at0002]/events[at0003]/time/value as cas,\n            t/data[at0002]/events[at0003]/data[at0001]/items[at0004]/value/magnitude as temperatura_vrednost,\n            t/data[at0002]/events[at0003]/data[at0001]/items[at0004]/value/units as temperatura_enota\n          from EHR e[e/ehr_id/value='#{ehrId}']\n          contains OBSERVATION t[openEHR-EHR-OBSERVATION.body_temperature.v1]\n          where t/data[at0002]/events[at0003]/data[at0001]/items[at0004]/value/magnitude<35\n          order by t/data[at0002]/events[at0003]/time/value desc\n          limit 10\n        \"\"\".replace /(\\r\\n|\\n|\\r)/gm, \" \"\n        url = \"#{baseUrl}/query?#{$.param \"aql\": AQL}\"\n        title = \"Telesna temperatura\"\n        successHandler = (res, title, msgEl, addResult) ->\n          if res\n            rows= res.resultSet\n            results = \"\"\"\n              <table class=\"table table-striped table-hover\">\n                <tr>\n                  <th>Datum in ura</th>\n                  <th class=\"text-right\">#{title}</th>\n                </tr>\n              \"\"\"\n            results += addResult val for key, val of rows\n            $(\"#rezultatMeritveVitalnihZnakov\").append results + \"</table>\"\n          else\n            showMessage \"Ni podatkov!\", msgEl, Label.warning\n        addResult = (result) ->\n          \"\"\"<tr>\n            <td>#{result.cas}</td>\n            <td class=\"text-right\">\n              #{result.temperatura_vrednost} #{result.temperatura_enota}\n            </td>\n          </tr>\"\"\"\n       readResultsAsync sessionId, url, title, msgEl, successHandler, addResult\n\n# $ ->\n#   $(\"#preberiObstojeciEHR\").change ->\n#     $(\"#preberiSporocilo\").html \"\"\n#     $(\"#preberiEHRid\").val $(@).val()\n#   $(\"#preberiPredlogoBolnika\").change ->\n#     $(\"#kreirajSporocilo\").html \"\"\n#     podatki = $(@).val().split \",\"\n#     $(\"#kreirajIme\").val podatki[0]\n#     $(\"#kreirajPriimek\").val podatki[1]\n#     $(\"#kreirajDatumRojstva\").val podatki[2]\n#   $(\"#preberiObstojeciVitalniZnak\").change ->\n#     $(\"#dodajMeritveVitalnihZnakovSporocilo\").html \"\"\n#     podatki = $(@).val().split \"|\"\n#     $(\"#dodajVitalnoEHR\").val podatki[0]\n#     $(\"#dodajVitalnoDatumInUra\").val podatki[1]\n#     $(\"#dodajVitalnoTelesnaVisina\").val podatki[2]\n#     $(\"#dodajVitalnoTelesnaTeza\").val podatki[3]\n#     $(\"#dodajVitalnoTelesnaTemperatura\").val podatki[4]\n#     $(\"#dodajVitalnoKrvniTlakSistolicni\").val podatki[5]\n#     $(\"#dodajVitalnoKrvniTlakDiastolicni\").val podatki[6]\n#     $(\"#dodajVitalnoNasicenostKrviSKisikom\").val podatki[7]\n#     $(\"#dodajVitalnoMerilec\").val podatki[8]\n#   $(\"#preberiEhrIdZaVitalneZnake\").change ->\n#     $(\"#preberiMeritveVitalnihZnakovSporocilo\").html \"\"\n#     $(\"#rezultatMeritveVitalnihZnakov\").html \"\"\n#     $(\"#meritveVitalnihZnakovEHRid\").val $(@).val()\n","'use strict'\n\nescapeAql = (multilineAql) ->\n  multilineAql.replace /(\\r\\n|\\n|\\r)/gm, \" \"\n\ncalculateAge = (dateOfBirth) ->\n  Math.abs new Date(Date.now() - dateOfBirth.getTime()).getUTCFullYear() - 1970\n\ngetInitials = (name) ->\n  namesArray = name.trim().split ' '\n  [first, ..., last] = namesArray\n  \"#{first[0]}#{if namesArray.length > 1 then last[0] else \"\"}\".toUpperCase()\n\nApp.factory 'EhrLookup', () ->\n  baseUrl = \"https://rest.ehrscape.com/rest/v1\"\n  queryUrl = baseUrl + \"/query\"\n  username = encodeURIComponent \"ois.seminar\"\n  password = encodeURIComponent \"ois4fri\"\n\n  factoryObj = {}\n\n  factoryObj.getSessionId = ->\n    $.ajax\n      type: \"POST\"\n      url: \"#{baseUrl}/session?username=#{username}&password=#{password}\"\n      async: false\n    .responseJSON.sessionId\n\n  factoryObj.aqlQuery = (aql, sessionId, callback) ->\n    $.ajax\n      url: \"#{baseUrl}/query?#{$.param 'aql': aql}\"\n      type: 'GET',\n      headers:\n        \"Ehr-Session\": sessionId,\n      success: callback\n\n  factoryObj.lastValue = (select, contains, ehrId, sessionId, callback) ->\n    aql = escapeAql \"\"\"\n      select\n      #{select}\n      from EHR e[e/ehr_id/value='#{ehrId}']\n      contains OBSERVATION #{contains}\n      order by t/data[at0002]/events[at0003]/time/value desc\n      limit 1\n    \"\"\"\n    factoryObj.aqlQuery aql, sessionId, callback\n\n  factoryObj.getLastWeight = (ehrId, sessionId, callback) ->\n    select = \"t/data[at0002]/events[at0003]/data[at0001]/items[at0004, 'Body weight']/value/magnitude as value,\" +\n    \"t/data[at0002]/events[at0003]/data[at0001]/items[at0004, 'Body weight']/value/units as unit\"\n    contains = \"t[openEHR-EHR-OBSERVATION.body_weight.v1]\"\n    factoryObj.lastValue select, contains, ehrId, sessionId, callback\n\n  factoryObj.getLastHeight = (ehrId, sessionId, callback) ->\n    select = \"t/data[at0001]/events[at0002]/data[at0003]/items[at0004, 'Body Height/Length']/value/magnitude as value\"\n    contains = \"t[openEHR-EHR-OBSERVATION.height.v1]\"\n    factoryObj.lastValue select, contains, ehrId, sessionId, callback\n\n  factoryObj.getLastTemperature = (ehrId, sessionId, callback) ->\n    select = \"t/data[at0002]/events[at0003]/data[at0001]/items[at0004]/value/magnitude as value,\"+\n    \"t/data[at0002]/events[at0003]/data[at0001]/items[at0004]/value/units as unit\"\n    contains = \"t[openEHR-EHR-OBSERVATION.body_temperature.v1]\"\n    factoryObj.lastValue select, contains, ehrId, sessionId, callback\n\n  factoryObj.getLastPulse = (ehrId, sessionId, callback) ->\n    select = \"t/data[at0002]/events[at0003]/data[at0001]/items[at0004]/value/magnitude as value\"\n    contains = \"t[openEHR-EHR-OBSERVATION.heart_rate-pulse.v1]\"\n    factoryObj.lastValue select, contains, ehrId, sessionId, callback\n\n  factoryObj.getPersonalData = (ehrId, sessionId, callback) ->\n    url = \"#{baseUrl}/demographics/ehr/#{ehrId}/party\"\n    $.ajax\n      url: \"#{baseUrl}/demographics/ehr/#{ehrId}/party\"\n      type: \"GET\"\n      headers:\n        \"Ehr-Session\": sessionId\n      success: (data) ->\n        partyData = data.party\n        dateOfBirth = new Date partyData.dateOfBirth\n        fullName = \"#{partyData.firstNames} #{partyData.lastNames}\"\n        callback\n          name: fullName\n          initials: getInitials fullName\n          dateOfBirth: dateOfBirth\n          age: calculateAge dateOfBirth\n          gender: partyData.gender\n          ehrId: ehrId\n\n  factoryObj.getAllData = (ehrId, sessionId, callback) ->\n\n    isDone = (data) ->\n      return false if data is null\n      for k, v of data\n        return false if v is null\n      true\n\n    isDataDone = (data) ->\n      isDone(data.person) and\n      isDone(data.measurements.weight) and\n      isDone(data.measurements.height) and\n      isDone(data.measurements.bmi) and\n      isDone(data.measurements.pulse)\n\n    doCallback = (data, cb) ->\n      return if not isDataDone data\n      cb data\n\n    data =\n      person:\n        name: null\n        initials: null\n        dateOfBirth: null\n        age: null\n        gender: null\n        ehrId: null\n      measurements:\n        weight: { value: null, unit: null }\n        height: { value: null, unit: null }\n        temperature: { value: null, unit: null }\n        pulse: { value: null, unit: null }\n\n    factoryObj.getPersonalData ehrId, sessionId, (res) ->\n      data.person = res\n      doCallback data, callback\n\n    factoryObj.getLastWeight ehrId, sessionId, (res) ->\n      return if not res\n      d = res.resultSet[0]\n      data.measurements.weight.value = d.value\n      data.measurements.weight.unit = d.unit or 'kg'\n      doCallback data, callback\n\n    factoryObj.getLastHeight ehrId, sessionId, (res) ->\n      return if not res\n      d = res.resultSet[0]\n      data.measurements.height.value = d.value\n      data.measurements.height.unit = d.unit or 'cm'\n      doCallback data, callback\n\n    factoryObj.getLastTemperature ehrId, sessionId, (res) ->\n      return if not res\n      d = res.resultSet[0]\n      data.measurements.temperature.value = d.value\n      data.measurements.temperature.unit = d.unit or '°C'\n      doCallback data, callback\n\n    factoryObj.getLastPulse ehrId, sessionId, (res) ->\n      return if not res\n      d = res.resultSet[0]\n      data.measurements.pulse.value = d.value\n      data.measurements.pulse.unit = d.unit or 'bpm'\n      doCallback data, callback\n\n  factoryObj\n\n\n"]}